$(function(){$("form a.add_nested_fields").live("click",function(){var a=$(this).attr("data-association"),b=$("#"+a+"_fields_blueprint").html(),c=($(this).closest(".fields").find("input:first").attr("name")||"").replace(new RegExp("[[a-z]+]$"),"");if(c){var d=c.match(/[a-z_]+_attributes/g)||[],e=c.match(/[0-9]+/g);for(i=0;i<d.length;i++)e[i]&&(b=b.replace(new RegExp("(\\["+d[i]+"\\])\\[.+?\\]","g"),"$1["+e[i]+"]"))}var f=new RegExp("new_"+a,"g"),g=(new Date).getTime();return b=b.replace(f,g),$(this).before(b),!1}),$("form a.remove_nested_fields").live("click",function(){var a=$(this).prev("input[type=hidden]")[0];return a&&(a.value="1"),$(this).closest(".fields").hide("fast"),!1})})